*{box-sizing:border-box}:root{--bg: #1a1a1a;--bg-warm: #1e1d1b;--surface: #242424;--paper: #f8f5f0;--paper-shadow: rgba(0, 0, 0, .15);--ink: #1a1a1a;--accent: #8b7355;--accent-light: #a08060;--accent-glow: rgba(139, 115, 85, .3);--current: #c9a227;--correct: #5a9a6e;--wrong: #b54a4a;--text: #e8e4e0;--text-muted: #8a8580;--text-subtle: #5a5550;--font-serif: "Crimson Pro", Georgia, "Times New Roman", serif;--font-sans: "Inter", system-ui, -apple-system, sans-serif;--space-xs: .25rem;--space-sm: .5rem;--space-md: 1rem;--space-lg: 1.5rem;--space-xl: 2rem;--transition-fast: .15s ease;--transition-med: .25s ease}html,body{margin:0;padding:0;height:100%}body{font-family:var(--font-sans);background:var(--bg-warm);color:var(--text);line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#app{display:flex;flex-direction:column;min-height:100vh;position:relative}#musicStand{flex:1;display:flex;flex-direction:column;padding:var(--space-lg);padding-bottom:100px}#scoreHeader{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:var(--space-lg);padding:0 var(--space-md)}.score-title h1{font-family:var(--font-serif);font-size:1.75rem;font-weight:500;letter-spacing:-.01em;margin:0 0 var(--space-xs) 0;color:var(--text)}.lesson-subtitle{font-family:var(--font-serif);font-size:.95rem;font-style:italic;color:var(--text-muted)}.score-meta{display:flex;flex-direction:column;align-items:flex-end;gap:var(--space-xs)}.level-badge{font-family:var(--font-serif);font-size:1.1rem;font-weight:500;color:var(--accent-light);padding:var(--space-xs) var(--space-md);background:#8b73551a;border:1px solid var(--accent);border-radius:4px}.progress-text{font-size:.75rem;color:var(--text-muted)}#scoreContainer{display:flex;align-items:flex-start;justify-content:center;position:relative;padding-top:var(--space-md);min-height:280px}#notation{width:100%;max-width:1100px;display:flex;justify-content:center;min-height:250px}#notation svg{width:100%;height:auto;background:var(--paper);border-radius:2px;padding:var(--space-md) var(--space-lg);box-shadow:0 1px 3px var(--paper-shadow),0 4px 12px var(--paper-shadow),0 12px 40px var(--paper-shadow)}#notation:empty:after{content:""}#notation.scrolling-mode{overflow-y:auto;overflow-x:hidden;max-height:calc(100vh - 280px)}#notation.scrolling-mode svg{width:100%;height:auto}#countoff{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-family:var(--font-serif);font-size:8rem;font-weight:600;color:var(--current);opacity:0;pointer-events:none;z-index:100;text-shadow:0 0 40px rgba(201,162,39,.4);transition:opacity .1s}#countoff.visible{opacity:1}.note.current .notehead *,.note.current .stem,.note.current .flag *,.note.current .accid *{fill:var(--current)!important;stroke:var(--current)!important}.rest.current *{fill:var(--current)!important}.note.correct .notehead *,.note.correct .stem,.note.correct .flag *,.note.correct .accid *{fill:var(--correct)!important;stroke:var(--correct)!important}.note.wrong .notehead *,.note.wrong .stem,.note.wrong .flag *,.note.wrong .accid *{fill:var(--wrong)!important;stroke:var(--wrong)!important}.note.past .notehead *,.note.past .stem,.note.past .flag *,.note.past .accid *,.rest.past *{fill:#999!important;stroke:#999!important;opacity:.5}.theory-hint{max-width:800px;margin:var(--space-lg) auto 0;padding:var(--space-md) var(--space-lg);font-family:var(--font-serif);font-size:1.1rem;font-style:italic;color:var(--text);text-align:center;background:#8b73551a;border:1px solid rgba(139,115,85,.2);border-radius:8px;transition:opacity var(--transition-med)}.theory-hint[hidden]{display:none}#controlBar{position:fixed;bottom:var(--space-lg);left:50%;transform:translate(-50%);display:flex;align-items:center;gap:var(--space-lg);padding:var(--space-sm) var(--space-lg);background:var(--surface);border:1px solid rgba(255,255,255,.08);border-radius:50px;box-shadow:0 4px 20px #0000004d,0 0 0 1px #ffffff0d inset;z-index:50;transition:opacity var(--transition-med),transform var(--transition-med)}.control-section{display:flex;align-items:center;gap:var(--space-sm)}.play-btn{width:48px;height:48px;padding:0;display:flex;align-items:center;justify-content:center;background:var(--accent);border:none;border-radius:50%;color:#fff;cursor:pointer;transition:all var(--transition-fast)}.play-btn:hover{background:var(--accent-light);transform:scale(1.05)}.play-btn svg{width:20px;height:20px}.play-btn .icon-stop,.play-btn.playing .icon-play{display:none}.play-btn.playing .icon-stop{display:block}.control-label{font-size:.7rem;text-transform:uppercase;letter-spacing:.1em;color:var(--text-subtle)}.tempo-control{display:flex;align-items:center;gap:var(--space-xs)}.tempo-control input[type=number]{width:50px;padding:var(--space-xs) var(--space-sm);background:var(--bg);border:1px solid rgba(255,255,255,.1);border-radius:4px;color:var(--text);font-size:.875rem;text-align:center}.tempo-control input[type=number]:focus{outline:none;border-color:var(--accent)}.tempo-unit{font-size:.7rem;color:var(--text-subtle)}.level-btn{width:32px;height:32px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:1px solid rgba(255,255,255,.15);border-radius:50%;color:var(--text-muted);cursor:pointer;transition:all var(--transition-fast)}.level-btn:hover{background:#ffffff14;color:var(--text);border-color:#ffffff40}.level-btn svg{width:16px;height:16px}.level-indicator{font-size:.85rem;color:var(--text);min-width:70px;text-align:center}.options-btn{width:36px;height:36px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:none;border-radius:50%;color:var(--text-muted);cursor:pointer;transition:all var(--transition-fast)}.options-btn:hover{background:#ffffff14;color:var(--text)}.options-btn svg{width:20px;height:20px}.fingering-btn{width:36px;height:36px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:1px solid rgba(255,255,255,.15);border-radius:50%;color:var(--text-muted);cursor:pointer;transition:all var(--transition-fast)}.fingering-btn:hover{background:#ffffff14;color:var(--text);border-color:#ffffff40}.fingering-btn.active{background:var(--accent);border-color:var(--accent);color:#fff}.fingering-btn.active:hover{background:var(--accent-light);border-color:var(--accent-light)}.fingering-btn svg{width:20px;height:20px}.metronome-btn{width:36px;height:36px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:1px solid rgba(255,255,255,.15);border-radius:50%;color:var(--text-muted);cursor:pointer;transition:all var(--transition-fast)}.metronome-btn:hover{background:#ffffff14;color:var(--text);border-color:#ffffff40}.metronome-btn.active{background:var(--accent);border-color:var(--accent);color:#fff}.metronome-btn.active:hover{background:var(--accent-light);border-color:var(--accent-light)}.metronome-btn svg{width:20px;height:20px}.upload-btn{width:36px;height:36px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:1px solid rgba(255,255,255,.15);border-radius:50%;color:var(--text-muted);cursor:pointer;transition:all var(--transition-fast)}.upload-btn:hover{background:#ffffff14;color:var(--text);border-color:#ffffff40}.upload-btn svg{width:18px;height:18px}.practice-info{display:flex;justify-content:space-between;align-items:center;max-width:1100px;margin:0 auto var(--space-md);padding:var(--space-sm) var(--space-md);background:#8b735526;border:1px solid rgba(139,115,85,.25);border-radius:8px}.practice-info[hidden]{display:none}.practice-step{display:flex;flex-direction:column;gap:2px}.step-type{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.1em;color:var(--accent-light)}.step-desc{font-family:var(--font-serif);font-size:1rem;color:var(--text)}.practice-progress{display:flex;flex-direction:column;align-items:flex-end;gap:4px}.step-num{font-size:.75rem;color:var(--text-muted)}.progress-bar-container{width:180px;height:24px;position:relative;cursor:pointer;padding:8px 0}.progress-bar-track{width:100%;height:8px;background:#ffffff1a;border-radius:4px;overflow:hidden}.progress-fill{height:100%;background:var(--accent);border-radius:4px;transition:width .1s ease;pointer-events:none}.progress-thumb{position:absolute;top:50%;width:16px;height:16px;background:var(--accent-light);border:2px solid white;border-radius:50%;transform:translate(-50%,-50%);cursor:grab;transition:transform .1s ease,box-shadow .1s ease;box-shadow:0 2px 4px #0000004d}.progress-thumb:hover{transform:translate(-50%,-50%) scale(1.1);box-shadow:0 2px 8px #0006}.progress-thumb:active,.progress-bar-container.dragging .progress-thumb{cursor:grabbing;transform:translate(-50%,-50%) scale(1.2);box-shadow:0 2px 12px #00000080}.progress-bar-container:focus-visible{outline:2px solid var(--accent);outline-offset:4px;border-radius:4px}.progress-preview{position:fixed;background:var(--surface);border:1px solid rgba(255,255,255,.15);border-radius:8px;padding:var(--space-sm) var(--space-md);box-shadow:0 4px 20px #0006;z-index:300;pointer-events:none;opacity:0;transform:translateY(10px);transition:opacity .15s ease,transform .15s ease;min-width:200px;max-width:320px}.progress-preview.visible{opacity:1;transform:translateY(0)}.progress-preview-step{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.1em;color:var(--accent-light);margin-bottom:2px}.progress-preview-desc{font-family:var(--font-serif);font-size:1rem;color:var(--text);margin-bottom:var(--space-xs)}.progress-preview-num{font-size:.75rem;color:var(--text-muted)}.progress-bar{width:120px;height:4px;background:#ffffff1a;border-radius:2px;overflow:hidden}.exit-practice-btn{width:100%;padding:var(--space-sm) var(--space-md);margin-top:var(--space-sm);background:transparent;border:1px solid rgba(255,255,255,.15);border-radius:6px;color:var(--text-muted);font-size:.875rem;cursor:pointer;transition:all var(--transition-fast)}.exit-practice-btn:hover{background:#ffffff14;color:var(--text);border-color:#ffffff40}.exit-practice-btn[hidden]{display:none}.file-upload-label{display:flex;flex-direction:column;cursor:pointer}.file-upload-label span:first-child{font-size:.875rem;color:var(--text-muted)}.upload-hint{font-size:.7rem;color:var(--text-subtle)}.options-group input[type=file]{display:none}.options-panel{position:fixed;bottom:100px;right:var(--space-lg);width:280px;background:var(--surface);border:1px solid rgba(255,255,255,.1);border-radius:12px;box-shadow:0 8px 32px #0006;z-index:60;overflow:hidden}.options-panel[hidden]{display:none}.options-header{display:flex;justify-content:space-between;align-items:center;padding:var(--space-md);border-bottom:1px solid rgba(255,255,255,.08)}.options-header h2{font-family:var(--font-serif);font-size:1rem;font-weight:500;margin:0}.close-btn{width:28px;height:28px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:none;border-radius:50%;color:var(--text-muted);font-size:1.25rem;cursor:pointer;transition:all var(--transition-fast)}.close-btn:hover{background:#ffffff14;color:var(--text)}.options-group{padding:var(--space-md);border-bottom:1px solid rgba(255,255,255,.05)}.options-group:last-of-type{border-bottom:none}.options-group h3{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.1em;color:var(--text-subtle);margin:0 0 var(--space-sm) 0}.option-row{display:flex;justify-content:space-between;align-items:center;padding:var(--space-xs) 0;cursor:pointer}.option-row span{font-size:.875rem;color:var(--text-muted)}.option-row:hover span{color:var(--text)}.option-row input[type=checkbox]{width:18px;height:18px;accent-color:var(--accent);cursor:pointer}.option-row input[type=range]{width:80px;height:4px;accent-color:var(--accent);cursor:pointer}.options-group select{width:100%;padding:var(--space-sm);background:var(--bg);border:1px solid rgba(255,255,255,.1);border-radius:6px;color:var(--text);font-size:.875rem;cursor:pointer}.options-group select:focus{outline:none;border-color:var(--accent)}.options-footer{padding:var(--space-md);border-top:1px solid rgba(255,255,255,.05);text-align:center}.github-link{display:inline-flex;align-items:center;gap:var(--space-xs);font-size:.8rem;color:var(--text-muted);text-decoration:none;transition:color var(--transition-fast)}.github-link:hover{color:var(--text)}.fingering-panel{position:fixed;bottom:100px;left:var(--space-lg);background:var(--surface);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:var(--space-md);box-shadow:0 4px 20px #0000004d;z-index:40}.fingering-panel[hidden]{display:none}.fingering-content{display:flex;flex-direction:column;gap:var(--space-xs)}.fingering-hand{display:flex;align-items:center;gap:var(--space-sm)}.fingering-panel .hand-label{font-size:.7rem;font-weight:500;color:var(--text-subtle);width:30px}.fingering-numbers{font-family:var(--font-serif);font-size:1rem;color:var(--accent-light);letter-spacing:.3em}.fingering-tips{font-size:.75rem;color:var(--text-muted);margin-top:var(--space-sm);padding-top:var(--space-sm);border-top:1px solid rgba(255,255,255,.08)}.fingering-tips:empty{display:none}body.is-playing #controlBar{opacity:.6}body.is-playing #controlBar:hover{opacity:1}@media(max-width:900px){#musicStand{padding:var(--space-md);padding-bottom:90px}#scoreHeader{flex-direction:column;gap:var(--space-sm);text-align:center}.score-meta{align-items:center}#controlBar{gap:var(--space-md);padding:var(--space-sm) var(--space-md)}.control-label{display:none}.level-indicator{font-size:.8rem;min-width:60px}.options-panel{right:var(--space-md);width:260px}}@media(max-width:900px)and (orientation:landscape){#musicStand{padding:var(--space-sm) var(--space-md);padding-bottom:70px}#scoreHeader{flex-direction:row;margin-bottom:var(--space-sm)}.score-title h1{font-size:1.25rem}.lesson-subtitle{font-size:.8rem}#notation svg{padding:var(--space-sm) var(--space-md);max-height:calc(100vh - 140px)}#controlBar{bottom:var(--space-sm);padding:var(--space-xs) var(--space-md);gap:var(--space-md)}.play-btn{width:40px;height:40px}.level-btn{width:28px;height:28px}#countoff{font-size:5rem}.theory-hint{font-size:.8rem;margin-top:var(--space-sm)}.midi-options{display:none}.practice-info{flex-direction:row;gap:var(--space-sm)}.progress-bar{width:80px}}@media(max-width:600px){#musicStand{padding:var(--space-sm);padding-bottom:80px}#scoreHeader{padding:0}.score-title h1{font-size:1.25rem}.lesson-subtitle{font-size:.8rem}#notation svg{padding:var(--space-md);border-radius:0}#controlBar{left:var(--space-sm);right:var(--space-sm);transform:none;width:auto;border-radius:24px;justify-content:space-between}.tempo-control input[type=number]{width:44px}.level-indicator{display:none}#countoff{font-size:6rem}.options-panel{left:var(--space-sm);right:var(--space-sm);width:auto;bottom:80px}.fingering-panel{left:var(--space-sm);right:var(--space-sm);bottom:80px}.midi-options{display:none}.practice-info{padding:var(--space-xs) var(--space-sm)}.step-type{font-size:.6rem}.step-desc{font-size:.875rem}.step-num{font-size:.65rem}.progress-bar{width:60px}}@media(hover:none)and (pointer:coarse){.play-btn,.level-btn,.options-btn,.close-btn{min-width:44px;min-height:44px}.play-btn:hover,.level-btn:hover,.options-btn:hover{transform:none;background:inherit}.play-btn:active{transform:scale(.95)}}@media(prefers-reduced-motion:reduce){*,*:before,*:after{transition-duration:.01ms!important;animation-duration:.01ms!important}}@media print{body{background:#fff}#controlBar,#optionsPanel,#countoff,.fingering-panel,.theory-hint{display:none!important}#musicStand{padding:0}#notation svg{box-shadow:none;border:1px solid #ddd}}.celebration-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#000000b3;z-index:200;animation:fadeIn .3s ease}.celebration-overlay[hidden]{display:none}.celebration-content{text-align:center;position:relative}.celebration-text{font-family:var(--font-serif);font-size:4rem;font-weight:600;color:var(--current);text-shadow:0 0 40px rgba(201,162,39,.6);animation:celebratePulse .6s ease infinite alternate}.celebration-sparkles{position:absolute;inset:-100px;pointer-events:none}.celebration-sparkles:before,.celebration-sparkles:after{content:"";position:absolute;width:8px;height:8px;border-radius:50%;background:var(--current);box-shadow:0 0 10px var(--current),0 0 20px var(--current);animation:sparkle 1.5s ease-in-out infinite}.celebration-sparkles:before{top:20%;left:20%;animation-delay:0s}.celebration-sparkles:after{top:30%;right:20%;animation-delay:.3s}.celebration-sparkles .particle{position:absolute;width:6px;height:6px;border-radius:50%;background:var(--accent-light);animation:sparkle 1.2s ease-in-out infinite}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes celebratePulse{0%{transform:scale(1)}to{transform:scale(1.05)}}@keyframes sparkle{0%,to{opacity:0;transform:scale(0) translateY(0)}50%{opacity:1;transform:scale(1) translateY(-20px)}}:focus-visible{outline:2px solid var(--accent);outline-offset:2px}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
